"use strict";angular.module("agencyApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.router","ngTagsInput","angular-bootstrap-select","underscore"]),angular.module("agencyApp").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",controller:["$scope",function(a){a.agencies=[]}],views:{"listAgency@":{templateUrl:"views/listAgency.html",controller:"ListagencyCtrl"},"filter@":{templateUrl:"views/filter.html",controller:"FilterCtrl"},"addNewAgency@":{templateUrl:"views/addNewAgency.html",controller:"AddnewagencyCtrl"}}})}]),angular.module("agencyApp").controller("ListagencyCtrl",["$scope","apiservice",function(a,b){a.$parent.agencies=[],a.$parent.list_load_status="",b.filterAgency({name:"",tags:[]},function(b){a.$parent.agencies=b.agencies,a.$parent.list_load_status=""},function(){a.$parent.list_load_status="error"})}]),angular.module("agencyApp").controller("FilterCtrl",["$scope","apiservice","_",function(a,b,c){a.filterList=function(){var d=[];c.each(a.filter.tagsModel,function(b,c){d.push(a.filter.tagsModel[c].text)}),a.filter.tags=d,b.filterAgency(a.filter,function(b){a.$parent.agencies=b.agencies,a.$parent.list_load_status=""},function(){a.$parent.list_load_status="error"})}}]),angular.module("agencyApp").controller("AddnewagencyCtrl",["$scope","$timeout","apiservice","_",function(a,b,c,d){a.add_status="",a.agency={grade:"1"},a.submit=function(){a.add_status="loading";var b=angular.copy(a.agency.tagsModel),e="";d.each(b,function(a,c){e=0===c?b[c].text:e+","+b[c].text}),a.agency.tags=e,c.addAgency(a.agency,function(b){a._setStatus("success");var c="";d.each(b.tags,function(a,d){c=0===d?b.tags[d].name:c+","+b.tags[d].name});var e={grade:b.grade,name:b.name,description:b.description,tags:c,id:b.id};a.$parent.agencies.push(e),a.agency={grade:"1"},a.formAdd.$setPristine()},function(){a._setStatus("error")})},a._setStatus=function(c){a.add_status=c,b(function(){a.add_status=""},3e3)}}]),angular.module("agencyApp").service("apiservice",["$resource",function(a){return a(GLOBALS.api+":methodName/:id",{method:"@method"},{addAgency:{method:"POST",params:{methodName:"create_agency"}},filterAgency:{method:"POST",params:{methodName:"filter_agencies"}}})}]);